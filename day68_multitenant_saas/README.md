# Day68 - マルチテナントSaaS基盤システム

企業向けタスク管理SaaSを例とした、本格的なマルチテナント対応SaaS基盤システムです。

## 🎯 学習目標

### 主要な学習要素
1. **テナント分離戦略**: Row-level security方式による安全なデータ分離
2. **課金・プラン管理**: 使用量ベース課金とリソース制限
3. **セキュリティ境界**: テナント間データ漏洩防止と監査ログ
4. **スケーラビリティ**: 動的リソース配分とパフォーマンス監視

## 🏗️ システム設計

### テナント分離アーキテクチャ
- **データ分離**: SQLiteのRow-level security + tenant_id による分離
- **認証**: JWT + テナント情報埋め込み
- **API設計**: マルチテナント対応RESTful API

### 課金システム
- **使用量トラッキング**: ユーザー数、ストレージ使用量、API呼び出し数
- **プラン管理**: Starter/Professional/Enterprise
- **請求書生成**: 月次自動課金

## 🚀 実装機能

### 1. テナント管理システム
- [ ] テナント登録・設定
- [ ] プラン選択・変更
- [ ] 使用量・課金状況確認

### 2. マルチテナント タスク管理
- [ ] プロジェクト作成・管理
- [ ] タスク作成・アサイン・進捗管理
- [ ] チームメンバー管理

### 3. 課金・プラン管理
- [ ] 使用量メトリクス収集
- [ ] プラン制限チェック
- [ ] 請求書生成

### 4. システム管理者機能
- [ ] 全テナント監視ダッシュボード
- [ ] リソース使用状況分析
- [ ] システム健全性確認

### 5. セキュリティ・監査
- [ ] テナント間アクセス制御
- [ ] 操作ログ・監査証跡
- [ ] セキュリティ境界検証

## 💻 技術仕様

### 使用技術
- **フレームワーク**: Next.js 15 (App Router)
- **言語**: TypeScript
- **データベース**: SQLite + better-sqlite3
- **認証**: JWT + テナント情報
- **スタイリング**: Tailwind CSS v4
- **状態管理**: Zustand

### データ分離方式
```sql
-- Row-level security example
CREATE TABLE tasks (
  id INTEGER PRIMARY KEY,
  tenant_id TEXT NOT NULL,
  title TEXT NOT NULL,
  -- その他のカラム
);

-- 全クエリでtenant_id条件を自動付与
```

### 課金モデル
```typescript
interface PricingPlan {
  name: 'starter' | 'professional' | 'enterprise';
  maxUsers: number;
  maxProjects: number;
  storageGB: number;
  apiCallsPerMonth: number;
  pricePerUser: number;
}
```

## 🎨 UI/UX設計

### デザインテーマ
**Professional SaaS Design** - 信頼性と効率性を重視したビジネス向けUI

### 主要画面
1. **テナント選択・切替画面**
2. **ダッシュボード**: 使用状況・課金情報
3. **タスク管理画面**: プロジェクト・タスク一覧
4. **チーム管理画面**: メンバー追加・権限管理
5. **設定・課金画面**: プラン変更・請求書確認
6. **管理者画面**: システム全体監視

## 🔧 セットアップ

```bash
cd day68_multitenant_saas
npm install
npm run dev
```

ブラウザで http://localhost:3001 にアクセス

## 📊 学習ポイント

### 1. マルチテナント設計パターン
- テナント分離戦略の比較検討
- セキュリティ境界の実装方法
- スケーラビリティの考慮事項

### 2. SaaS課金システム
- 使用量ベース課金の実装
- プラン制限の動的チェック
- 請求書生成ロジック

### 3. 実運用を意識した設計
- 監査ログ・コンプライアンス対応
- パフォーマンス監視・最適化
- 障害対応・復旧戦略

---

**Day68の挑戦**: エンタープライズ級マルチテナントSaaSの基盤システムを構築し、実際のSaaS運営で必要となる技術要素を体験的に学習します。
