# Day44 - 署名付きグループチャット

## 概要

ユーザーが登録し、公開鍵・秘密鍵ペアをローカルで管理しつつ、グループチャットに参加できるアプリケーションです。
メッセージは平文で送受信されますが、各メッセージには送信者のデジタル署名が付与され、受信側で検証されます。
当初はE2E暗号化を目指していましたが、グループチャットの複雑性を考慮し、スコープを署名付き平文チャットに変更しました。

## 主な機能

- ユーザー登録 (RSAキーペア生成、公開鍵サーバー保存)
- ユーザー選択によるアカウント切り替え
- グループチャットルームでのメッセージ送受信
- メッセージへのRSA-PSS署名と検証
- 5秒ごとのメッセージポーリングによる準リアルタイム更新

## デザイン

- ニューモーフィズム

## 使用技術

- Next.js (App Router)
- TypeScript
- Tailwind CSS
- better-sqlite3 (SQLite)
- Web Crypto API

## 起動方法

1. リポジトリをクローンします。
2. `day44_e2e_encrypted_chat` ディレクトリに移動します。
   ```bash
   cd day44_e2e_encrypted_chat
   ```
3. 必要なパッケージをインストールします。
   ```bash
   npm install
   ```
4. 開発サーバーを起動します。
   ```bash
   npm run dev
   ```
5. ブラウザで `http://localhost:3001/chat` を開きます。

## 画面構成と使い方

1.  **ユーザー登録:**
    *   トップページ (`/chat`) の「ユーザー管理」セクションで任意のユーザー名を入力し、「登録」ボタンをクリックします。
    *   これにより、RSAの暗号化用・署名用のキーペアがブラウザ内で生成され、秘密鍵はlocalStorageに、公開鍵はサーバーのDBに保存されます。
    *   登録が完了すると、完了を知らせるアラートが表示されます。
2.  **ユーザー選択:**
    *   「あなたのアカウント」ドロップダウンから、チャットに使用するアカウントを選択します。
    *   選択すると、対応する秘密鍵がlocalStorageから読み込まれ、グループチャットルームが表示されます。
3.  **メッセージ送受信:**
    *   チャットルーム下部の入力欄にメッセージを入力し、「送信」ボタンをクリックします。
    *   送信されたメッセージは、選択中ユーザーの署名用秘密鍵で署名された後、サーバーに送信されます。
    *   チャットルームには、自分と他のユーザーのメッセージが表示されます。
    *   メッセージは5秒ごとに自動でポーリングされ、新しいメッセージが画面に反映されます。
    *   各メッセージには送信者名と送信時刻が表示されます。自分のメッセージは右側に、他人のメッセージは左側に表示されます。
    *   メッセージ受信時には署名が検証され、もし検証に失敗した場合はメッセージ内容の先頭に `[署名検証失敗]` と表示されます（正常な操作では発生しないはずです）。

---

&copy; 2024 Your Name (or Project Name)
