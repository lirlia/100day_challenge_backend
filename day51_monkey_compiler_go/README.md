# Day51 - Monkey 言語コンパイラ

## 概要

Go言語を使用してMonkey言語のコンパイラと仮想マシン(VM)を実装するプロジェクトです。コンパイラの基本的な仕組みを学ぶことを目的とした簡略版の実装です。

## 主な学習ポイント

- プログラミング言語のコンパイラとVMの内部構造
- バイトコードの設計と生成
- スタックベースの仮想マシンの実装
- Go によるデータ構造とアルゴリズムの実装

## 機能要件

### サポートする言語機能

- **リテラル:** 整数、真偽値
- **演算子:** 算術演算 (+, -, *, /)、比較演算 (<, >, ==, !=)、論理演算 (!)
- **変数束縛:** let 文 (グローバルスコープのみ)
- **制御フロー:** if 式
- **組み込み関数:** puts (引数を画面に出力)
- **REPL:** インタラクティブな実行環境

### 除外した機能

- 文字列リテラル
- 関数定義とユーザー定義関数呼び出し
- 配列、ハッシュ
- ローカルスコープの変数

## アーキテクチャ

```
Monkey ソースコード
      ↓
    Lexer (字句解析)
      ↓
    Token 列
      ↓
    Parser (構文解析)
      ↓
    AST (抽象構文木)
      ↓
   Compiler (コンパイル)
      ↓
   Bytecode (バイトコード)
      ↓
     VM (仮想マシン)
      ↓
    実行結果
```

## ディレクトリ構成

- `token/` - トークンの定義
- `lexer/` - 字句解析器
- `ast/` - 抽象構文木の定義
- `parser/` - 構文解析器
- `code/` - バイトコードのオペコード定義
- `compiler/` - コンパイラとシンボルテーブル
- `object/` - オブジェクトシステム
- `vm/` - 仮想マシン
- `repl/` - REPL実装

## 使用方法

```bash
# REPL の起動
go run main.go

# 例: 変数の定義と演算
>> let a = 5;
>> let b = 10;
>> puts(a + b);
15

# 例: if 式
>> let x = 3;
>> if (x > 0) { puts(1); } else { puts(0); }
1
```

## 実装進捗

### ステップ 1/10: プロジェクト初期化と基本型定義 ✅

- [x] プロジェクトディレクトリ作成
- [x] Go Module 初期化
- [x] `token/token.go` - トークン定義
- [x] `ast/ast.go` - AST ノード定義
- [x] `object/object.go` - オブジェクトシステム定義
- [x] `README.md` 作成
- [x] `PROGRESS.md` 作成

### ステップ 2/10: 字句解析器 (Lexer) の実装とテスト

- [ ] `lexer/lexer.go` 実装
- [ ] `lexer/lexer_test.go` テスト作成

### ステップ 3/10: AST ノードの拡充

- [ ] `ast/ast_test.go` テスト作成

### ステップ 4-5/10: 構文解析器 (Parser) の実装とテスト

- [ ] `parser/parser.go` 実装
- [ ] `parser/parser_test.go` テスト作成

### ステップ 6/10: バイトコード (Opcode) 定義と命令生成

- [ ] `code/code.go` 実装
- [ ] `code/code_test.go` テスト作成

### ステップ 7-8/10: コンパイラの実装とテスト

- [ ] `compiler/symbol_table.go` 実装
- [ ] `compiler/compiler.go` 実装
- [ ] テスト作成

### ステップ 9/10: 仮想マシン (VM) の実装とテスト

- [ ] `vm/vm.go` 実装
- [ ] `vm/vm_test.go` テスト作成

### ステップ 10/10: REPL の実装と全体統合

- [ ] `repl/repl.go` 実装
- [ ] `main.go` 実装
- [ ] 動作確認とドキュメント更新

## 技術仕様

- **言語:** Go
- **パッケージ管理:** Go Modules
- **テスト:** Go 標準の `testing` パッケージ
- **VM アーキテクチャ:** スタックベース
- **バイトコード:** カスタム設計
- **対象Monkey言語:** 簡略版 (関数、配列、ハッシュを除く) 
